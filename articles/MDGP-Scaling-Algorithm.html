<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MDGP-Scaling-Algorithm • Landscape Scaling of Categorical Raster Data</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="MDGP-Scaling-Algorithm">
<meta property="og:description" content="landscapeScaling">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Landscape Scaling of Categorical Raster Data</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/MDGP-Scaling-Algorithm.html">MDGP-Scaling-Algorithm</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gannd/landscapeScaling/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>MDGP-Scaling-Algorithm</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gannd/landscapeScaling/blob/HEAD/vignettes/MDGP-Scaling-Algorithm.Rmd" class="external-link"><code>vignettes/MDGP-Scaling-Algorithm.Rmd</code></a></small>
      <div class="hidden name"><code>MDGP-Scaling-Algorithm.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gannd/landscapeScaling" class="external-link">landscapeScaling</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/terra/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; terra 1.6.17</span></span></code></pre></div>
<div class="section level2">
<h2 id="spatial-scaling-of-categorical-data">Spatial Scaling of Categorical Data<a class="anchor" aria-label="anchor" href="#spatial-scaling-of-categorical-data"></a>
</h2>
<p>The purpose of the “landscapeScaling” package is to provide a method
and the supporting functions to upscale categorical raster data. The
recommended method is the multi-dimensional grid-point (mdgp) scaling
algorithm <span class="citation">Gann (2019)</span>. This algorithm
generates a new classification scheme on the basis of user desired class
label precision of mixed classes and representativeness of the scaled
class across the landscape of interest. The scaling output provides
scaled categorical raster maps with mixed classes, a corresponding
continuous raster with information retention calculations for each
scaled grid cell and class-specific and landscape-scale mean and
standard deviation of compositional information retention.</p>
</div>
<div class="section level2">
<h2 id="conceptual-background">Conceptual Background<a class="anchor" aria-label="anchor" href="#conceptual-background"></a>
</h2>
<p>Categorical raster data sets often require up-scaling or aggregation
to a lower spatial resolution to make them compatible with other data
sets or the scale of analysis. Despite validity of classification
schemes for a limited range of spatial scales, most data aggregation
algorithms for categorical data are insensitive to scale dependence of
the classification scheme. This leads to high, uncontrolled and most
often unknown loss of compositional information at the scaled grid cell
scale, while potentially extending the high-resolution classification
scheme beyond its valid scale range.</p>
<p>Here we define the compositional information retention when scaling a
high-resolution data set to a lower aggregated form with the Czekanowski
Index:</p>
<p><span class="math display">\[IR_{c} = \sum_{i-1}^{N} min(P_{i}smp,
P_{i}scaled)\]</span> <span class="math inline">\(IR_{c}\)</span> is the
compositional information retention; <span class="math inline">\(P_{i}smp\)</span> is the proportion of class <span class="math inline">\(i\)</span> of the high-resolution grid within the
scaled grid cell, and <span class="math inline">\(P_{i}scaled\)</span>
is the proportion of class <span class="math inline">\(i\)</span>
retained in the scaled grid cell label. The loss of information for
majority- and nearest-neighbor rule aggregation are demonstrated for a
small subset of a 9 x 9 grid cell landscape aggregated with a scale
factor of 3 and 9.</p>
<div class="figure">
<img src="figures/Figure-infoLoss.png" style="width:75.0%" alt=""><p class="caption">Figure 1 Compositional information loss when
upscaling categorical data while maintaining the high-resolution
classification scheme. Richness of the original landscape is three
(classes a,b and c). Aggregation with the majority rule and
nearest-neighbor rule and a scale factor of 3 and 9 leads to high
information loss not accounting for any mixed classes. Adapted from
<span class="citation">Gann and Richards (2022)</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="multi-dimensional-grid-point-scaling">Multi-Dimensional Grid-Point Scaling<a class="anchor" aria-label="anchor" href="#multi-dimensional-grid-point-scaling"></a>
</h2>
<p>The MDGP-Scaling algorithm aggregates categorical data while
simultaneously generating a non-hierarchical, representative,
classification system for the aggregated spatial scale. The scaled data
consistently preserves information at a significantly higher rate than
other aggregation algorithms that do not account for classification
scheme dependence (e.g., majority rule, nearest-neighbor rule).</p>
<p>The algorithm controls for information loss with the parameter <span class="math inline">\(parts\)</span>, which relates to the scaled
class-label precision of mixed classes. The larger the parameter (the
more parts), the more classes will be generated with increasing
precision of class-label components in the scaled class labels. The
number of potential classes is determined by the richness of the
original raster, and the precision parameter <span class="math inline">\(parts\)</span>. Setting <span class="math inline">\(parts\)</span> to 1 (precision = 100%) is equal to
the most commonly used alternative method of majority (plurality)
rule.</p>
<div class="figure">
<img src="figures/Figure-gridPointsMDGP.png" style="width:85.0%" alt=""><p class="caption">Figure 2 Multi-dimensional grid points generated for
class-label precisions ranging from 100% (parts = 1) to 20% (parts = 5).
As richness of the original landscape increases the dimensionality of
the multi-dimensional grid points increases (blue box). Adopted from
<span class="citation">Gann (2019)</span>.</p>
</div>
<p>Scaling the small three class example landscape in Fig.1 with a scale
factor of 9 (all 81 grid cells are replaced by 1 scaled grid cell) and
the 1-part (precision = 100%, the majority-rule), 2-part (precision =
50%), 3-part (precision = 33.33%), and 4-part (precision = 25%)
precision solutions generate the respective multi-dimensional grid
points. For each precision level, the scaled cell assigned to the grid
point that maximizes <span class="math inline">\(IR_{c}\)</span>.
Comparison across all solutions indicates the maximum information
retained for the given precision level.</p>
<div class="figure">
<img src="figures/Figure-infoLossMDGP.png" style="width:75.0%" alt=""><p class="caption">Figure 3 Multi-dimensional grid points generated for
label precisions ranging from 100% (parts = 1) to 25% (parts = 4) (top
to bottom). Richness of the original landscape is three (classes a,b and
c). The scaled class label list for each precision level (LabelList) is
the enumerated list of all grid points. The solution that maximizes
categorical information retention <span class="math inline">\(IR_{c}\)</span> for each grid-point solution is
emphasized in bold. The last column summarizes the grid-point
information the grid cell is assigned. Maximum <span class="math inline">\(IR_{c}\)</span> increases with precision. Adopted
from <span class="citation">Gann and Richards (2022)</span>.</p>
</div>
<p>Consdering the representativeness of a scaled class across the scaled
landscape (study area), in addition to the class label precision
parameter <span class="math inline">\(parts\)</span> the
representativeness threshold parameter <span class="math inline">\(rpr-threshold\)</span> determines which scaled
grid-point classes are retained. A third parameter <span class="math inline">\(monotypic-threshold\)</span> determines the
threshold for class abundance to be considered a monotypic class and to
be retained in the final classification scheme even when present at less
than the representativeness threshold across the landscape.</p>
</div>
<div class="section level2">
<h2 id="procedure-for-mdgp-scaling">Procedure for MDGP-Scaling<a class="anchor" aria-label="anchor" href="#procedure-for-mdgp-scaling"></a>
</h2>
<p>The functions for MDGP-Scaling can be divided into two types of
functions. The vignette explores the low-level functions that follow a
step-wise procedure of the scaling process. The high-level function that
nests several functions to produce a scaled product from the raw
categorical raster input is the ‘mdgp_scale_raster’ function.</p>
<p>First we load a neutral landscape that had been generated with the
mid-point replacement algorithm in the NLMR package <span class="citation">(Sciaini et al. 2018)</span>. The landscape has three
classes (richness) with a geometric class abundance distribution and a
spatial aggregation of 0. For demonstration purpose we first subset the
original raster to the lower left chunk of 90,000 grid cells (300 by 300
cells).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load categorical raster data set and plot</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/nlm_mid_geom_r3_sa0.tif"</span>, package <span class="op">=</span> <span class="st">"landscapeScaling"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set the three class color scheme</span></span>
<span><span class="va">clr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#332288'</span>,<span class="st">'#44AA99'</span>,<span class="st">'#DDCC77'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the original categorical raster</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r</span>, col<span class="op">=</span><span class="va">clr</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">1.5</span>,<span class="fl">0.75</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define a subset extent to encompass the lower left 300 by 300 cells (for demo purpose) </span></span>
<span><span class="va">sub_ext</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">300</span>,<span class="fl">0</span>,<span class="fl">300</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add the extent outline to the plot (white outline)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sub_ext</span>, border<span class="op">=</span><span class="st">'white'</span>,lwd<span class="op">=</span><span class="fl">2</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MDGP-Scaling-Algorithm_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>Figure 4 The original raster with three classes and the subset extent
in the lower left corner (outline in white).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subset the landscape and plot</span></span>
<span><span class="va">r_sub</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="va">r</span>,<span class="va">sub_ext</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_sub</span>,col<span class="op">=</span><span class="va">clr</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">1.5</span>,<span class="fl">0.75</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="MDGP-Scaling-Algorithm_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>Figure 5 The subset of the categorical raster.</p>
<div class="section level4">
<h4 id="scaling-process-steps">Scaling Process Steps<a class="anchor" aria-label="anchor" href="#scaling-process-steps"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Generate the scaled grid with the ‘scale_grid’ function applying a
scale factor of 15. First the lower left corner of the 15 by 15 grid
cells will be generated.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LL_pnts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scale_grid.html">scale_grid</a></span><span class="op">(</span><span class="va">r_sub</span>,scale_factor<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">LL_pnts</span><span class="op">)</span></span>
<span><span class="co">#&gt;    x y</span></span>
<span><span class="co">#&gt; 1  0 0</span></span>
<span><span class="co">#&gt; 2 15 0</span></span>
<span><span class="co">#&gt; 3 30 0</span></span>
<span><span class="co">#&gt; 4 45 0</span></span>
<span><span class="co">#&gt; 5 60 0</span></span>
<span><span class="co">#&gt; 6 75 0</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_sub</span>,col<span class="op">=</span><span class="va">clr</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">1.5</span>,<span class="fl">0.75</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="va">LL_pnts</span>,geom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">)</span>,pch<span class="op">=</span><span class="fl">3</span>,col<span class="op">=</span><span class="st">'#EEEEEE'</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MDGP-Scaling-Algorithm_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>Figure 6 The subset of the categorical raster and the scaled grid
cell origin (lower left corners)</p>
<ol start="2" style="list-style-type: decimal">
<li>Generate the relative abundance of original classes for a specific
scale factor using the ‘relative_abundance_scaled_grid’ function. The
lower left corner of of each of the 15 by 15 scaled grid cells is
generated, followed by the tabulation of relative abundance of the
high-resolution classes within each scaled grid cell. The x and y
coordinates of the lower left corner for each scaled grid cell and the
relative abundance for each cell are returned as data frame.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rel_abund</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relative_abundance_scaled_grid.html">relative_abundance_scaled_grid</a></span><span class="op">(</span><span class="va">r_sub</span>,class_field<span class="op">=</span><span class="st">'cover'</span>,scale_factor<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rel_abund</span><span class="op">)</span></span>
<span><span class="co">#&gt;    x y          A        B        C</span></span>
<span><span class="co">#&gt; 1  0 0  4.8888889 38.22222 56.88889</span></span>
<span><span class="co">#&gt; 2 15 0 10.2222222 38.66667 51.11111</span></span>
<span><span class="co">#&gt; 3 30 0 20.0000000 42.66667 37.33333</span></span>
<span><span class="co">#&gt; 4 45 0 24.8888889 40.44444 34.66667</span></span>
<span><span class="co">#&gt; 5 60 0  0.8888889 28.00000 71.11111</span></span>
<span><span class="co">#&gt; 6 75 0 17.7777778 37.33333 44.88889</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Classify the relative abundance of each scaled grid cell to a list
of multi-dimensional grid points that are generated from the class label
precision parameter <span class="math inline">\(parts\)</span> and the
landscape richness (number of classes). The ‘mdgp_scale’ function
requires the argument <span class="math inline">\(parts\)</span> for the
class label precision, the representativeness threshold <span class="math inline">\(prp-threshold\)</span>, and the monotypic class
threshold <span class="math inline">\(monotypic-threshold\)</span>. A
set of multi-dimensional grid points is generated for the selected
precision level and the richness of the original raster layer. Then each
scaled grid cell is classified to the grid point that maximizes
information retention. The function returns for each scaled grid cell
the original class abundance, the lower left corner coordinate (x_y),
scaled class label and the corresponding information retention as a data
frame.</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># classify relative abundance samples to multi-dimensional grid points with a 33.3% class label precision and a 10 percent representativeness threshold and a monotypic class threshold of 90%</span></span>
<span><span class="va">mdgp_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdgp_scale.html">mdgp_scale</a></span><span class="op">(</span><span class="va">rel_abund</span>,parts<span class="op">=</span><span class="fl">3</span>,rpr_threshold<span class="op">=</span><span class="fl">10</span>,monotypic_threshold<span class="op">=</span><span class="fl">90</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "number of cells: 400"</span></span>
<span><span class="co">#&gt; [1] "number of grid points: 10"</span></span>
<span><span class="co">#&gt; [1] "number of grid points remaining: 5"</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mdgp_result</span><span class="op">)</span></span>
<span><span class="co">#&gt;   cls      A      B      C    x_y prc_inf_agr class_name</span></span>
<span><span class="co">#&gt; 1  10  0.000  8.444 91.556  285_0      91.556       C100</span></span>
<span><span class="co">#&gt; 2  10  0.000  9.333 90.667 195_30      90.667       C100</span></span>
<span><span class="co">#&gt; 3  10  0.444 12.444 87.111 60_285      87.111       C100</span></span>
<span><span class="co">#&gt; 4   9  4.889 38.222 56.889    0_0      90.222  C67_x_B33</span></span>
<span><span class="co">#&gt; 5   9 10.222 38.667 51.111   15_0      84.444  C67_x_B33</span></span>
<span><span class="co">#&gt; 6   9 10.667 42.667 46.667  225_0      80.000  C67_x_B33</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Convert the classified points and the corresponding
location-specific information retention and summarize information
retention at the class-level and across the scaled landscape with the
function ‘scaling_result_to_raster’.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># convert classified points and location-specific information retention to raster</span></span>
<span><span class="va">mdgp_raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scaling_result_to_raster.html">scaling_result_to_raster</a></span><span class="op">(</span><span class="va">mdgp_result</span>,class_name_field<span class="op">=</span><span class="st">'class_name'</span>,scale_factor<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the scaled map</span></span>
<span><span class="va">clr_scale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'#E69F00'</span>,<span class="st">'#56B4E9'</span>,<span class="st">'#009E73'</span>,<span class="st">'#F0E442'</span>,<span class="st">'#0072B2'</span>,<span class="st">'#D55E00'</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mdgp_raster</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,col<span class="op">=</span><span class="va">clr_scale</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">1.5</span>,<span class="fl">1</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="MDGP-Scaling-Algorithm_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>Figure 7 The scaled categorical raster with a new scaled
classification scheme.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot information retention of the scaled map</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mdgp_raster</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">20</span>,start<span class="op">=</span><span class="fl">0.1</span>,end<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="MDGP-Scaling-Algorithm_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>Figure 8 Information retention raster at the scaled grid cell
level.</p>
<p>A third list with two objects returns the class-specific mean and
standard deviation of information retention as a data frame and the
landscape scale aggregated mean and standard deviation as a list.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print the class-specific and landscape scale summary statistics </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mdgp_raster</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;        class_name freq class_id   prop inf_retention_mn inf_retention_sd</span></span>
<span><span class="co">#&gt; 1 A33_x_B33_x_C33  165        1 0.4125           84.129            3.814</span></span>
<span><span class="co">#&gt; 2       A67_x_B33  122        2 0.3050           87.417            6.519</span></span>
<span><span class="co">#&gt; 3       B67_x_A33   29        3 0.0725           82.038            2.214</span></span>
<span><span class="co">#&gt; 4            C100    3        4 0.0075           89.778            2.352</span></span>
<span><span class="co">#&gt; 5       C67_x_B33   81        5 0.2025           88.093            5.132</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;                                   mean    sd</span></span>
<span><span class="co">#&gt; information_retention_landscape 85.826 5.356</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="results-for-the-entire-landscape">Results for the Entire Landscape<a class="anchor" aria-label="anchor" href="#results-for-the-entire-landscape"></a>
</h3>
<p>The next two figures present the scaling results for the full
landscape when applying a with scale factor of 5 (Fig. 9) and 15 (Fig.
10) for three precision levels of 100%, 33.3% and 20%.</p>
<div class="figure">
<img src="figures/Figure-LS-SF5.png" style="width:90.0%" alt=""><p class="caption">Figure 9 Neutral landscape generated with nlme
mid-point displacement algorithm. Richness of the landscape is three
(classes A,B and C) with a geomtric class distribution and an
aggregation factor of 0.0, scaled with a scale factor of 5 and class
label precision ranging from 100% (parts=1) to 33,3% (parts=3) and 20%
(parts=5). Circle size displays absolute scale of class proportions
(Prop_AS) across all plots; colour rendered as relative scale of class
proportions (Prop_RS) within each plot. Small black dots in the terneray
plots indicate that the potential grid point was not realized at the
aggregated scale. Class labels are composed of class name and nominal
percent representativeness. Adopted from <span class="citation">Gann
(2019)</span>.</p>
</div>
<p>Scaling the full landscape with a scale factor of 15 and three
precision levels of 100%, 33.3% and 20%.</p>
<div class="figure">
<img src="figures/Figure-LS-SF15.png" style="width:90.0%" alt=""><p class="caption">Figure 10 Neutral landscape generated with nlme
mid-point displacement algorithm. Richness of the landscape is three
(classes A,B and C) with a geomtric class distribution and an
aggregation factor of 0.0, scaled with a scale factor of 15 and class
label precision ranging from 100% (parts=1) to 33,3% (parts=3) and 20%
(parts=5). Circle size displays absolute scale of class proportions
(Prop_AS) across all plots; colour rendered as relative scale of class
proportions (Prop_RS) within each plot. Small black dots in the terneray
plots indicate that the potential grid point was not realized at the
aggregated scale. Class labels are composed of class name and nominal
percent representativeness. Adopted from <span class="citation">Gann
(2019)</span>.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="aknowledgements">Aknowledgements<a class="anchor" aria-label="anchor" href="#aknowledgements"></a>
</h2>
<p>This package generously relies on functions from the R packages terra
<span class="citation">(Hijmans 2022)</span>, compositions <span class="citation">(van den Boogaart, Tolosana-Delgado, and Bren
2022)</span>, and partitions <span class="citation">(Hankin
2006)</span>.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Gann_2019" class="csl-entry">
Gann, Daniel. 2019. <span>“Quantitative Spatial Upscaling of Categorical
Information: The Multi-Dimensional Grid-Point Scaling Algorithm.”</span>
<em>Methods in Ecology and Evolution</em> 10 (12): –14. <a href="https://doi.org/10.1111/2041-210X.13301" class="external-link">https://doi.org/10.1111/2041-210X.13301</a>.
</div>
<div id="ref-Gann_Richards_2022" class="csl-entry">
Gann, Daniel, and Jennifer Richards. 2022. <span>“<a href="">Scaling of
Classification Systems — Effects of Class Precision on Detection
Accuracy from Medium Resolution Multispectral Data – in
Press</a>.”</span> <em>Landscape Ecology</em>.
</div>
<div id="ref-partitions" class="csl-entry">
Hankin, R. K. S. 2006. <span>“Additive Integer Partitions in r.”</span>
<em>Journal of Statistical Software, Code Snippets</em> 16 (May).
</div>
<div id="ref-terra" class="csl-entry">
Hijmans, Robert J. 2022. <em>Terra: Spatial Data Analysis</em>. <a href="https://CRAN.R-project.org/package=terra" class="external-link">https://CRAN.R-project.org/package=terra</a>.
</div>
<div id="ref-NLMR" class="csl-entry">
Sciaini, Marco, Matthias Fritsch, Cedric Scherer, and Craig E. Simpkins.
2018. <span>“NLMR and Landscapetools: An Integrated Environment for
Simulating and Modifying Neutral Landscape Models in r.”</span>
<em>Methods in Ecololgy and Evolution</em> 00: 1–9. <a href="https://doi.org/10.1111/2041-210X.13076" class="external-link">https://doi.org/10.1111/2041-210X.13076</a>.
</div>
<div id="ref-compositions" class="csl-entry">
van den Boogaart, K. Gerald, Raimon Tolosana-Delgado, and Matevz Bren.
2022. <em>Compositions: Compositional Data Analysis</em>. <a href="https://CRAN.R-project.org/package=compositions" class="external-link">https://CRAN.R-project.org/package=compositions</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Daniel Gann.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
